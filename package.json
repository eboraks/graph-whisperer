{
  "name": "graph-whisperer",
  "displayName": "Graph Whisperer",
  "description": "Professional-grade VS Code extension for RDF/SPARQL development, optimized for GraphDB.",
  "license": "AGPL-3.0-or-later",
  "publisher": "eboraks",
  "repository": {
    "type": "git",
    "url": "https://github.com/eboraks/graph-whisperer.git"
  },
  "icon": "resources/icon.png",
  "version": "0.0.1",
  "engines": {
    "vscode": "^1.90.0"
  },
  "categories": [
    "Programming Languages",
    "Data Science"
  ],
  "activationEvents": [],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "graphwhisperer.runQuery",
        "title": "Run SPARQL Query",
        "icon": "$(play)"
      },
      {
        "command": "graphwhisperer.setPassword",
        "title": "Set GraphDB Password"
      },
      {
        "command": "graphwhisperer.refreshOntology",
        "title": "Refresh Ontology",
        "icon": "$(refresh)"
      },
      {
        "command": "graphwhisperer.searchOntology",
        "title": "Search Ontology",
        "icon": "$(search)"
      }
    ],
    "chatParticipants": [
      {
        "id": "graphwhisperer",
        "name": "graphwhisperer",
        "description": "Ask questions about your GraphDB ontology and schema.",
        "isSticky": true
      }
    ],
    "keybindings": [
      {
        "command": "graphwhisperer.runQuery",
        "key": "ctrl+enter",
        "mac": "cmd+enter",
        "when": "editorLangId == sparql"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "graphwhisperer-sidebar",
          "title": "Graph Whisperer",
          "icon": "resources/activity-bar-icon.svg"
        }
      ],
      "panel": [
        {
          "id": "graphwhisperer",
          "title": "SPARQL Results",
          "icon": "resources/activity-bar-icon.svg"
        }
      ]
    },
    "views": {
      "graphwhisperer-sidebar": [
        {
          "id": "graphwhisperer.ontology",
          "name": "Ontology Explorer",
          "icon": "resources/activity-bar-icon.svg"
        }
      ],
      "graphwhisperer": [
        {
          "id": "graphwhisperer.results",
          "name": "Query Results",
          "type": "webview",
          "icon": "resources/activity-bar-icon.svg"
        }
      ]
    },
    "menus": {
      "view/title": [
        {
          "command": "graphwhisperer.refreshOntology",
          "when": "view == graphwhisperer.ontology",
          "group": "navigation"
        },
        {
          "command": "graphwhisperer.searchOntology",
          "when": "view == graphwhisperer.ontology",
          "group": "navigation"
        }
      ]
    },
    "languages": [
      {
        "id": "sparql",
        "aliases": [
          "SPARQL",
          "sparql"
        ],
        "extensions": [
          ".sparql",
          ".rq"
        ],
        "configuration": "./language-configuration.json"
      }
    ],
    "grammars": [
      {
        "language": "sparql",
        "scopeName": "source.sparql",
        "path": "./syntaxes/sparql.tmLanguage.json"
      }
    ],
    "configuration": {
      "title": "Graph Whisperer",
      "properties": {
        "graphwhisperer.endpoint": {
          "type": "string",
          "default": "http://localhost:7200/repositories/my-repo",
          "description": "URL to the GraphDB endpoint."
        },
        "graphwhisperer.username": {
          "type": "string",
          "default": "",
          "description": "Username for Basic Authentication."
        },
        "graphwhisperer.password": {
          "type": "string",
          "default": "",
          "description": "Password for Basic Authentication. WARNING: Use the 'Set Password' command for better security. This field is stored in plain text."
        },
        "graphwhisperer.agent.introspectionSkill": {
          "type": "string",
          "editPresentation": "multilineText",
          "description": "Instructions for the agent on how to introspect the SPARQL endpoint.",
          "default": "## name: sparql-introspection description: Probes a SPARQL endpoint to discover classes, properties, and graph structure.\n\n# SPARQL Introspection Skill\n\nThis skill allows the agent to query the connected triplestore to understand its schema dynamically.\n\n## Goal\n\nTo provide the AI agent with grounded knowledge of the graph's classes and predicates so it can suggest accurate SPARQL patterns instead of hallucinating schema names.\n\n## Instructions\n\n1. **Identify the Endpoint:** Extract the current SPARQL endpoint URL and credentials.\n2. **Execute Probes:** Run the following queries to gather context:\n\n### Query to List Classes\n\nSELECT DISTINCT ?class WHERE { ?s a ?class. } LIMIT 50\n\n### Query to Find Classes/Properties by Keyword\n\nIf the user mentions a specific term (e.g., \"Human\", \"species\") but you are unsure of the IRI, search for it:\n\n```sparql\nSELECT DISTINCT ?match ?type WHERE {\n  { ?match a rdfs:Class . BIND(\"Class\" AS ?type) }\n  UNION\n  { ?match a rdf:Property . BIND(\"Property\" AS ?type) }\n  FILTER(CONTAINS(LCASE(STR(?match)), \"keyword\"))\n} LIMIT 10\n```\n\n### Query to List Properties for a Class\n\nIf the user mentions a specific class (e.g., `schema:Person`), probe its predicates:\n\n```sparql\nSELECT DISTINCT ?p WHERE {\n ?s a <CLASS_URI> ; ?p ?o.\n} LIMIT 50\n```\n\n### Query for Property Usage (Statistical)\n\n```sparql\nSELECT ?p (COUNT(*) AS ?usage) WHERE {\n ?s ?p ?o.\n} GROUP BY ?p ORDER BY DESC(?usage) LIMIT 20\n```\n\n## Verification\n\nBefore finalizing any query for the user, **you must verify your assumptions** about the schema.\n\n- **Check existence:** `ASK { ?s a vocab:Character }`\n- **Check property domain:** `ASK { ?s a vocab:Character ; vocab:species ?o }`\n\n## Constraints\n\n- **Read-Only:** Only execute `SELECT` or `ASK` queries for introspection.\n- **Performance:** Always apply a `LIMIT` to introspection queries.\n- **Feedback:** If a probe fails, report the specific error to the user immediately.\n- **No Hallucinations:** Do not guess IRI names. Use the \"Keyword Search\" or \"Property Usage\" queries to find the actual names."
        },
        "graphwhisperer.agent.rules": {
          "type": "string",
          "editPresentation": "multilineText",
          "description": "General rules and guidelines for the Graph Whisperer agent.",
          "default": "## name: graph-whisperer-dev description: Guidelines for building the GraphWhisperer VS Code extension using Node.js and SPARQL.\n\n# GraphWhisperer Development Rules\n\nYou are an expert VS Code Extension developer specializing in Semantic Web technologies (SPARQL/RDF). Follow these rules when generating code for the GraphWhisperer project.\n\n## Architecture & Frameworks\n\n* **Language:** Use TypeScript exclusively for the extension logic.\n* **Foundation:** Follow the standard VS Code Extension lifecycle. Register commands and providers in the `activate` function of `extension.ts`.\n* **Query Execution:** Use the `sparql-http-client` library (ESM version) for all endpoint interactions.\n* **Result Visualization:**\n  * For `SELECT` queries, use the `<vscode-data-grid>` component from the `@vscode/webview-ui-toolkit`.\n  * For `CONSTRUCT` queries, use a collapsible tree view like `@uiw/react-json-view`.\n\n## SPARQL Query Standards\n\n* **SPARQL 1.1:** Adhere strictly to W3C SPARQL 1.1 Query and Update specifications.\n* **Best Practices:**\n  * Always include `PREFIX` declarations to improve readability.\n  * Use `LIMIT` by default for exploratory queries to prevent endpoint timeouts.\n  * Prefer `VALUES` or specific triple patterns over complex `FILTER` regex for performance.\n\n## Webview & Security\n\n* **Content Security Policy (CSP):** Every webview must implement a strict CSP that restricts script and style sources.\n* **Theming:** Use CSS variables (e.g., `var(--vscode-editor-foreground)`) to ensure the UI matches the user's active IDE theme.\n* **Credentials:** Use the `vscode.secrets` API to store SPARQL endpoint credentials safely; never store them in workspace settings.\n\n## Agentic Integration\n\n* **Chat Participant:** Register the `@graphwhisperer` chat participant to handle natural language query requests within the IDE.\n* **Model Context Protocol (MCP):** When building introspection tools, prioritize the MCP standard to ensure compatibility with both Antigravity and Cursor."
        }
      }
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run build:webview && npm run compile",
    "build:webview": "vite build",
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "pretest": "npm run compile && npm run lint",
    "lint": "eslint src",
    "test": "vscode-test"
  },
  "devDependencies": {
    "@tanstack/react-table": "^8.21.3",
    "@types/node": "^20.0.0",
    "@types/react": "^19.2.13",
    "@types/react-dom": "^19.2.3",
    "@types/sparqljs": "^3.1.3",
    "@types/vscode": "^1.90.0",
    "@vitejs/plugin-react": "^5.1.4",
    "@vscode/test-cli": "^0.0.10",
    "@vscode/test-electron": "^2.4.1",
    "eslint": "^9.0.0",
    "react": "^19.2.4",
    "react-dom": "^19.2.4",
    "typescript": "^5.5.0",
    "vite": "^7.3.1"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.26.0",
    "@uiw/react-json-view": "^2.0.0-alpha.41",
    "sparql-http-client": "^3.0.0",
    "sparqljs": "^3.7.1",
    "typescript-eslint": "^8.14.0",
    "zod": "^4.3.6"
  }
}
